# EchoStream

> åŸºäºŽ QUIC çš„é«˜æ€§èƒ½å¼‚æ­¥åŒå‘ RPC å’Œæµä¼ è¾“æ¡†æž¶ï¼Œè®©å®žæ—¶é€šä¿¡åƒå†™æœ¬åœ°å‡½æ•°ä¸€æ ·ç®€å•ã€‚

## é¡¹ç›®ç®€ä»‹

ä¸“ä¸ºå®žæ—¶é€šä¿¡åœºæ™¯è®¾è®¡çš„ Rust RPC æ¡†æž¶ï¼Œèžåˆä¼ ç»Ÿ RPC çš„ä¾¿åˆ©æ€§å’Œå®žæ—¶æµä¼ è¾“èƒ½åŠ›ï¼Œé€šè¿‡ QUIC åè®®åœ¨å•è¿žæŽ¥ä¸ŠåŒæ—¶å¤„ç†æŽ§åˆ¶ä¿¡ä»¤å’Œå®žæ—¶æ•°æ®æµã€‚

## æ ¸å¿ƒç‰¹æ€§

- **ðŸ”„ å¼‚æ­¥åŒå‘é€šä¿¡**: å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½å¯ä»¥ä¸»åŠ¨å‘èµ·è¯·æ±‚ã€å‘é€äº‹ä»¶å’ŒæŽ¨é€æµæ•°æ®
- **ðŸ“¡ å¤šæ¨¡æ€ä¿¡ä»¤**: æ”¯æŒ Request/Responseã€Event å’Œ Stream ä¸‰ç§é€šä¿¡æ¨¡å¼
- **ðŸŽµ æµå¼ä¼ è¾“**: æ”¯æŒéŸ³è§†é¢‘ç­‰å®žæ—¶æ•°æ®çš„ä½Žå»¶è¿Ÿä¼ è¾“ï¼Œé…å¤‡æŠ–åŠ¨ç¼“å†²å’Œæ—¶é—´æˆ³å¯¹é½
- **â± æ—¶é—´åŒæ­¥**: å†…ç½®ç±» NTP æ—¶é’ŸåŒæ­¥åè®®ï¼Œç¡®ä¿åˆ†å¸ƒå¼èŠ‚ç‚¹é—´çš„æ—¶é—´å¯¹é½
- **ðŸš€ åŸºäºŽ QUIC**: åˆ©ç”¨ QUIC çš„ 0-RTT æ¡æ‰‹ã€å¤šè·¯å¤ç”¨å’Œè‡ªåŠ¨æ‹¥å¡žæŽ§åˆ¶
- **ðŸ” æœåŠ¡å‘çŽ°**: åŸºäºŽ mDNS çš„é›¶é…ç½®å±€åŸŸç½‘æœåŠ¡å‘çŽ°ï¼ˆå¯é€‰ï¼‰
- **ðŸ›¡ å®‰å…¨ä¼ è¾“**: å†…ç½® TLS 1.3 åŠ å¯†ï¼Œæ”¯æŒè‡ªç­¾åå’Œ CA è¯ä¹¦
- **ðŸ§© æ’ä»¶ç³»ç»Ÿ**: æ¨¡å—åŒ–æ‰©å±•æœºåˆ¶ï¼Œæ”¯æŒç”Ÿå‘½å‘¨æœŸ hook å’Œé…ç½®å®šåˆ¶
- **ðŸ¦€ å¼€å‘å‹å¥½**: æä¾›å£°æ˜Žå¼ API å’Œè¿‡ç¨‹å®ï¼Œæœ€å°åŒ–æ ·æ¿ä»£ç 

## ä½¿ç”¨åœºæ™¯

EchoStream ç‰¹åˆ«é€‚ç”¨äºŽéœ€è¦åŒæ—¶å¤„ç†æŽ§åˆ¶æŒ‡ä»¤å’Œå®žæ—¶æ•°æ®çš„åœºæ™¯ï¼š

- **å®žæ—¶éŸ³è§†é¢‘é€šä¿¡**: ä½Žå»¶è¿ŸéŸ³è§†é¢‘ä¼ è¾“ï¼Œæ”¯æŒå¤šè·¯å¤ç”¨å’Œæ—¶é—´åŒæ­¥
- **ç‰©è”ç½‘è®¾å¤‡æŽ§åˆ¶**: å‘½ä»¤ä¸‹å‘ã€çŠ¶æ€ä¸ŠæŠ¥å’Œæ•°æ®æµé‡‡é›†
- **æ¸¸æˆç½‘ç»œ**: æ¸¸æˆçŠ¶æ€åŒæ­¥ã€äº‹ä»¶å¹¿æ’­å’Œè¯­éŸ³é€šä¿¡
- **è¿œç¨‹æ¡Œé¢**: å±å¹•å…±äº«ã€è¾“å…¥æŽ§åˆ¶å’ŒéŸ³é¢‘è½¬å‘
- **åˆ†å¸ƒå¼ç³»ç»Ÿ**: èŠ‚ç‚¹é—´é€šä¿¡ã€æ•°æ®åŒæ­¥å’Œäº‹ä»¶æ€»çº¿

## é¡¹ç›®æž¶æž„

é‡‡ç”¨ Cargo Workspace ç®¡ç†çš„ monorepo æž¶æž„:

```
echostream/
â”œâ”€â”€ Cargo.toml               # Workspace å®šä¹‰
â”œâ”€â”€ crates/                  # æ‰€æœ‰ Rust crates
â”‚   â”œâ”€â”€ echostream/          # ç»Ÿä¸€å…¥å£ï¼Œé‡å¯¼å‡ºæ‰€æœ‰å…¬å…± API
â”‚   â”œâ”€â”€ echostream-core/     # æ ¸å¿ƒæ¡†æž¶(RPCã€æµä¼ è¾“ã€è¿žæŽ¥ç®¡ç†)
â”‚   â”œâ”€â”€ echostream-discovery/# æœåŠ¡å‘çŽ°(mDNS)
â”‚   â”œâ”€â”€ echostream-derive/   # è¿‡ç¨‹å®(handlerã€listenerã€stream_handler)
â”‚   â””â”€â”€ echostream-types/    # å…¬å…±ç±»åž‹å’Œé”™è¯¯å®šä¹‰
â”œâ”€â”€ examples/                # ç¤ºä¾‹ä»£ç 
â”‚   â”œâ”€â”€ simple_rpc.rs        # åŸºç¡€ RPC è°ƒç”¨ç¤ºä¾‹
â”‚   â”œâ”€â”€ event_bus.rs         # äº‹ä»¶æ€»çº¿ç¤ºä¾‹
â”‚   â”œâ”€â”€ audio_stream.rs      # éŸ³é¢‘æµä¼ è¾“ç¤ºä¾‹
â”‚   â””â”€â”€ service_discovery.rs # æœåŠ¡å‘çŽ°ç¤ºä¾‹
â””â”€â”€ sdk/                     # å…¶ä»–è¯­è¨€ç»‘å®š(æœªæ¥)
    â”œâ”€â”€ nodejs/              # Node.js ç»‘å®š
    â””â”€â”€ python/              # Python ç»‘å®š
```

## å­åŒ…è¯´æ˜Ž

### [echostream](../crates/echostream/README.md)

ç»Ÿä¸€å…¥å£ crateï¼Œé‡å¯¼å‡ºæ‰€æœ‰å…¬å…± APIï¼Œæä¾› `prelude` æ¨¡å—ã€‚

### [echostream-core](../crates/echostream-core/README.md)

æ ¸å¿ƒæ¡†æž¶ï¼Œå®žçŽ° RPC å’Œæµä¼ è¾“èƒ½åŠ›:

- è¿žæŽ¥ç®¡ç†ã€åè®®å±‚ã€RPC æ¡†æž¶
- æµç®¡ç†ã€æ’ä»¶ç³»ç»Ÿ
- æœåŠ¡ç«¯/å®¢æˆ·ç«¯å®žçŽ°

### [echostream-types](../crates/echostream-types/README.md)

å…¬å…±ç±»åž‹ã€é”™è¯¯å®šä¹‰å’Œå·¥å…·å‡½æ•°:

- é”™è¯¯ç±»åž‹ã€ä¸Šä¸‹æ–‡ç±»åž‹
- Session ä¼šè¯ã€æ—¶é—´æˆ³ç±»åž‹

### [echostream-derive](../crates/echostream-derive/README.md)

è¿‡ç¨‹å®ï¼Œç®€åŒ–å¤„ç†å™¨å®šä¹‰:

- `handler` å®ï¼šè¯·æ±‚å¤„ç†å™¨
- `listener` å®ï¼šäº‹ä»¶ç›‘å¬å™¨
- `stream_handler` å®ï¼šæµå¤„ç†å™¨

### [echostream-discovery](../crates/echostream-discovery/README.md)

åŸºäºŽ mDNS çš„å±€åŸŸç½‘æœåŠ¡å‘çŽ°:

- æœåŠ¡å¹¿æ’­ã€æœåŠ¡å‘çŽ°
- æœåŠ¡è§£æžã€é›¶é…ç½®

## å¿«é€Ÿä¸Šæ‰‹

> **å¼€å‘ä¸­ï¼Œæ•¬è¯·æœŸå¾…...**

### å®‰è£…

```toml
[dependencies]
echostream = "0.1"
```

### ç¤ºä¾‹ä»£ç 

æ›´å¤šç¤ºä¾‹è¯·æŸ¥çœ‹ [examples](../examples/) ç›®å½•ã€‚

```rust
use echostream::prelude::*;

// æœåŠ¡ç«¯
#[echostream::handler("hello")]
async fn hello(session: Session, name: String) -> Result<String> {
    Ok(format!("Hello, {}!", name))
}

#[tokio::main]
async fn main() -> Result<()> {
    let server = RpcServer::builder()
        .bind("0.0.0.0:5000")
        .handler(hello)
        .build()?;
    server.run().await
}

// å®¢æˆ·ç«¯
#[tokio::main]
async fn main() -> Result<()> {
    let client = RpcClient::connect("127.0.0.1:5000").await?;
    let response: String = client.request("hello", "World").await?;
    println!("{}", response); // Hello, World!
    Ok(())
}
```

## License

MIT License Â© 2026-PRESENT [Del Wang](https://del.wang)
